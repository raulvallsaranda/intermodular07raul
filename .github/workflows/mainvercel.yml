name: Modificació Repositori i Desplegament Vercel

env:

  VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}

  VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}

on:

  push:

    branches:

      - main

jobs:

  Desplegar:

    runs-on: ubuntu-latest

    permissions:
      contents: write
      
    steps:

      - name: Descarrega codi del repositori Github
        uses: actions/checkout@v6
        
      - name: Modifica fitxer md
        run: |
          echo -e "- Desplegament Vercel Github Actions:  "`date` >> README.md
      - name: Modifica fitxer index.html
        run: |
          data=`date`
          sed -i "s/<\/ul>/    <li>${date}<\/li>\n\t<\/ul>/" index.html
          
      - name: commit i push
        run: |
          git config --global user.name "${{ github.actor }}"
          git config --global user.email "${{ github.actor }}@users.noreply.github.com"
          git add --all
          git commit -m "Afegit contingut fitxer fitxerExecucions.txt"
          git push
          
      - name: Instal·lar Vercel CLI
        run: npm install --global vercel@latest

      - name: Descarrega informació de l’entorn de Vercel
        run: vercel pull --yes --environment=production --token=${{ secrets.VERCEL_TOKEN }}

      - name: Fer el build
        run: vercel build --prod --token=${{ secrets.VERCEL_TOKEN }}

      - name: Desplegar a Vercel
        run: vercel deploy --prebuilt --prod --token=${{ secrets.VERCEL_TOKEN }}
